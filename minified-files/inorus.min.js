let currentSelector,language;const setCurrentSelector=a=>{currentSelector=a},setLang=a=>{language=a},modal={open:a=>{document.querySelector('.cover').style.display='block',document.querySelector('.cover .text').innerHTML=a.target.innerText},close:()=>{document.querySelector('.cover .text').innerHTML='',document.querySelector('.cover').style.display='none',document.querySelector('.suggestionText').value=''}};function configModal(){document.querySelector('.suggestionButton').addEventListener('click',()=>{const a=document.querySelector('.suggestionText').value;firebase.database().ref('/suggestions/'+language).once('value').then(function(b){let c='/suggestions/'+language+'/'+currentSelector;if(null!=b.val()){var d=!1;for(const e in b.val()[currentSelector])if(b.val()[currentSelector][e].text.toUpperCase()===a.toUpperCase()){5>b.val()[currentSelector][e].calls?firebase.database().ref(c).child(e).update({calls:b.val()[currentSelector][e].calls+1}):(firebase.database().ref(c).child(e).set({}),defaultLanguage===language?firebase.database().ref('/all/'+language+'/'+currentSelector).update({text:a,length:a.length}):firebase.database().ref('/all/'+language+'/'+currentSelector).update({text:a}),getData(language)),d=!0;break}if(!d){const e=firebase.database().ref(c).push();e.set({text:a,calls:1})}}else{const e=firebase.database().ref(c).push();e.set({text:a,calls:1})}})}),document.querySelector('.suggestionButton').addEventListener('click',()=>{modal.close()}),document.querySelector('.suggestionCancel').addEventListener('click',()=>{modal.close()}),document.addEventListener('keydown',function(a){const b=a.key;'Escape'===b&&modal.close()})}function createModal(){const a=document.getElementsByTagName('body'),b=document.createElement('div');b.setAttribute('class','cover modal'),b.style.display='none';const c=document.createElement('div');c.setAttribute('class','content');const d=document.createElement('div');d.setAttribute('class','text');const e=document.createElement('textarea');e.setAttribute('class','suggestionText');const f=document.createElement('button');f.setAttribute('class','suggestionButton'),f.textContent='Send suggestion';const g=document.createElement('button');g.setAttribute('class','suggestionCancel'),g.textContent='Cancel',c.appendChild(d),c.appendChild(e),c.appendChild(f),c.appendChild(g),b.appendChild(c),a[0].appendChild(b),configModal()}var elements=document.getElementsByClassName('inorus'),phrases=[],element,phrase,sizeFont;function Element(a){this.element=a;var b=window.getComputedStyle(a).fontSize;this.sizeFont=b,this.phrase=a.innerText}function compare(a,b){var c=phrases[a],d=parseInt(b);if(c.element.innerText.length>d){var e=c.element.innerText.length/d;e=2<=e?2.5:1;var f=e*(d*parseFloat(c.sizeFont.replace('px',''))/c.element.innerText.length);c.element.style.setProperty('font-size',f+'px','important')}else phrases[a].element.style.setProperty('font-size',phrases[a].sizeFont,'important')}function countPhrases(a){for(var b=0;b<a.length;b++)phrases.push(new Element(a[b]))}function preencher(a,b){0==phrases.length&&countPhrases(elements);for(var c=0;c<phrases.length;c++)'ar'==b?changeAlignment(phrases[c].element,'right'):changeAlignment(phrases[c].element,'left'),''!=phrases[c].element.id&&(phrases[c].element.innerText=a[b][phrases[c].element.id].text,compare(c,a[b][phrases[c].element.id].length),addClickListener(phrases[c].element,a))}let current_language;function addClickListener(a){a.addEventListener('click',function(c){setCurrentSelector(c.target.getAttribute('id')),modal.open(c)})}function getData(a){current_language=a,setLang(a),fetch('https://inorus-840b6.firebaseio.com/all.json',{method:'get'}).then(function(b){return b.json()}).then(function(b){document.body.style.display='block',createSelect(b),preencher(b,a)}).catch(function(b){console.log(b)})}function selectItemByValue(a,b){for(var c=0;c<a.options.length;c++)if(a.options[c].value===b){a.selectedIndex=c;break}}function createSelect(a){if(null==document.getElementById('inorus-select')){var b=document.getElementsByTagName('body'),c=document.createElement('select');c.id='inorus-select',c.style.setProperty('float','right'),b[0].insertBefore(c,b[0].firstChild),showLanguages(c,a),selectItemByValue(c,current_language),c.addEventListener('change',function(d){getData(d.target.value)})}}function showLanguages(a,b){for(var e,c=Object.keys(b),d=0;d<c.length;d++)e=document.createElement('option'),e.value=c[d],e.text=c[d],a.appendChild(e)}function changeAlignment(a,b){a.style.setProperty('text-align',b,'important')}createModal();const defaultLanguage='pt';getData(defaultLanguage);